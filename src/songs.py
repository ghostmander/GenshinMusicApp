from . import song_parser
import pyautogui, pydirectinput
import time


class Song:
    def __init__(self, name: str, notes: str, bpm: int = 240, encoding: str = "default"):
        self.name = name
        self.bpm = bpm
        self.notes = notes
        self.encoding = encoding

    def __getitem__(self, key):
        if hasattr(self, key.lower()):
            return getattr(self, key.lower())
        else:
            raise KeyError(f"KeyError: {key}")


songSheet: dict[str: Song] = {
    "TestSong": Song(name="Test Song", bpm=1000, encoding="default", notes="1  2  3  4  5  6"),
    "AlhaithamDemo": Song(
        name="Alhaitham demo song", bpm=512, encoding="default",
        notes="l 8 2 h 9 l 2 j 11 l 2 l 8 h 9 l 2 j 6 j 8 2 h 9 l 2 j 11 l 2 l 13 h 9 l 2 j 8 j 8 2 h 9 l 2 j 11 l 2 l 8 h 9 l 2 j 6 j 8 2 h 9 l 2 l 11 j 9 d l 10 1 h 2 h 8 4 j 1 h 2 h 2 j 1 h 2 h 4 j 4 7 h 8 2 h 1 7 j 1 h 2 h 4 6 j 1 h 2 h 2 j 1 h 2 h 4 j 6 h 2 h 1 j 10 1 h 2 h 8 4 j 1 h 2 h 2 j 1 h 2 h 12 4 j 6 j 11 l 2 h 10 1 j 14 1 h 2 h 15 4 j 1 h 2 l 14 j 2 j 1 j 13 l 2 j 4 j 2 f l 16 l 17 l 18 2 j 2 l 17 l 6 j 18 2 j 13 2 j 2 j 6 j 2 j 18 1 j 1 l 17 l 6 j 18 1 j 13 1 j 1 j 6 j 18 1 l 19 l 20 4 j 4 l 20 l 8 j 20 4 j 20 4 j 4 l 19 l 8 j 18 4 j 19 5 j 5 j 9 j 16 5 j 5 j 5 j 9 j 16 5 j 20 5 j 5 j 9 j 16 5 j 5 j 5 j 9 j 18 5 j 17 6 j 6 l 15 l 10 j 12 6 j 6 j 15 6 j 16 10 j 17 6 j 17 5 j 5 j 9 j 16 5 j 16 5 j 5 j 9 j 5 j 19 3 h 3 l 16 j 3 j 17 6 h 6 h 9 6 l 10 l 11 2 h 10 l 6 j 11 j 2 6 g 6 j 9 l 10 l 11 2 h 10 l 6 j 11 j 2 6 g 6 j 11 l 12 l 13 4 g 8 j 13 j 13 4 h 14 l 8 j 15 j 14 5 g 9 j 12 j 5 g 9 j 9 j 13 5 f 9 d 10 l 11 l 12 1 h 11 1 h 10 1 j 12 1 h 15 h 17 j 17 2 f 16 a j 7 h 8 h 7 j 2 f 6 a d j 10 2 f 8 a 12 g 11 g 10 j 14 2 f 15 f 14 f 13"
    ),
    "SweaterWeather": Song(
        name="Sweater Weather", bpm=210, encoding="ABC[1-5]",
        notes="B4 . . . . . B3 . . . . . B5 . . . A1A4B1 . . . . . . . . . . . . . . . A1A4B1B4 . . . . . B3 . . . . . B5 . . . A1A4B1 . . . . . . . . . . . B3 . . . A1A4B1B4 . . . . . . . B3 . . . B5 . . . A1A3B1 . . . . . . . . . . . . . . . A1A3B1B4 . . . . . . . B5 . . . B4 . . . A1A3A5 . . . . . . . . . . . B3 . . . A1A3A5B4 . . . . . . . B3 . . . B5 . . . A1A4B1 . . . . . . . . . . . . . . . A1A4B1B4 . . . . . B3 . . . . . B5 . . . A1A4B1 . . . . . . . . . . . B3 . . . A1A4B1B4 . . . . . . . B5 . . . B4 . . . A1A3B1 . . . B3 . . . B1 . . . B3 . . . A1A3B1B4 . . . . . B3 . B1 . . . B4 . . . A1A3A5 . . . . . . . B1 . . . B3 . . . A1A3A5B4 . . . B4 . . . B3 . . . B4 . . . A1A4B1B4 . . . . . . . . . . . B1 . . . A1A4B1B5 . . . B4 . . . B4 . . . B4 . . . A1A4B1 . . . B3 . . . . . . . . . . . A1A4B1B4 . . . B4 . . . B4 . . . B4 . . . A1A3B1 . . . . . . . B4 . . . B3 . . . A1A3B1B4 . . . B4 . . . B3 . . . B4 . . . A1A3A5B5 . . . . . . . . . . . . . . . A1A3A5B5 . . . . . . . B5 . . . . . . . A1A4B1B5 . . . . . . . . . . . B3 . . . A1A4B1B3 . . . . . C2 . . . . . B5 . . . A1A4B1 . . . . . . . . . . . . . . . A1A4B1B5 . . . B4 . . . B5 . . . . . . . A1A3B1B5 . . . B4 . . . B5 . . . . . . . A1A3B1B5 . . . . . . . B5 . . . . . . . A1A3A5B4 . . . . . . . . . . . . . . . A1A3A5B3 . . . . . . . B1 . . . . . . . A1A4B1 . . . B4 . . . B4 . . . B4 . B3 . A1A4B1B4 . . . B3 . B3 . . . . . . . . . A1A3A5 . . . . . . . . . B3 . B4 . B3 . A1A3A5B4 . . . B5 . B5 . . . . . . . . . A1A3B1 . . . B5 . . . B4 . . . . . . . A1A3B1 . . . B3 . . . B3 . . . . . . . A1A3A5 . . . B5 . . . B4 . . . . . . . A1A3A5 . . . B3 . . . B3 . . . . . . . A1A4B1 . . . B4 . . . B5 . . . . . . . A1A4B1 . . . B3 . . . B3 . . . . . . . A1A3A5 . . . B4 . . . B4 . . . . . . . A1A3A5 . . . B3 . . . B3 . . . . . . . A1A3B1B4 . B3 . B4 . . . B4 . B3 . B4 . B3 . A1A3B1B4 . . . B3 . . . B3 . . . B5 . . . A1A3A5 . . . . . . . . . . . B3 . . . A1A3A5B4 . . . . . . . B3 . . . . . . . A1A4B1B4 . . . B5 . . . B4 . . . B3 . . . B1 . . . . . . . C1 . . . . . . . A3B1B3B5 . . . . . . . . . . . . . . . B1 . . . . . . . C1 . . . . . . . A1A3B1B5 . . . . . . . . . . . . . . . . . . . . . . . . . . . B3 . . . A1A3A5B4 . . . . . . . . . . . B3 . . . B4 . . . . . . . B3 . . . . . . . A1A4B1B4 . . . B5 . . . B4 . . . B3 . . . B1 . . . . . . . C1 . . . . . . . A3B1B3B5 . . . . . . . . . . . . . . . B1 . . . . . . . C1 . . . . . . . A1A3B1B5 . . . . . . . . . . . B4 . . . . . . . . . . . . . . . B3 . . . A1A3A5B2 . . . . . . . B2 . . . B1 . . . B2 . . . B3 . . . . . . . B3 . . . A1A4B1B5 . . . B4 . . . B4 . . . B4 . . . A1A4B1B4 . . . B3 . B1 . . . . . . . . . A1A4B1B4 . B3 . B4 . . . B4 . B3 . B4 . . . A1A4B1B4 . . . B3 . B1 . . . . . . . B4 . A1A3B1 . B4 . . . B3 . B4 . . . B4 . . . A1A3B1B4 . . . B3 . B4 . . . . . . . B3 . A1A3A5B4 . . . B4 . B3 . B4 . . . B4 . . . A1A3A5B4 . . . B3 . B1 . . . . . . . . . A1A4B1 . . . . . B3 . B4 . . . B4 . . . A1A4B1B4 . . . B3 . B1 . . . . . . . B3 . A1A4B1B4 . B3 . B4 . B3 . B4 . . . B3 . . . A1A4B1B4 . . . B3 . B1 . . . . . . . . . A1A3B1 . . . . . . . . . B3 . B4 . B3 . A1A3B1B4 . . . B3 . B4 . . . . . B4 . B3 . A1A3A5B4 . B3 . B4 . B3 . B4 . . . B4 . B3 . A1A3A5B4 . . . B3 . B1 . . . . . B3 . . . A1A4B1 . . . . . . . . . . . B3 . . . A1A4B1B4 . . . B5 . B5 . . . . . . . . . A1A4B1B4 . B3 . B4 . B3 . B4 . B3 . B4 . . . A1A4B1B4 . . . B5 . B5 . . . . . . . . . A1A3B1 . . . B2 . . . B2 . . . B1 . . . A1A3B1B2 . . . B3 . . . B3 . . . . . . . A1A3A5 . . . C2 . . . B5 . . . B4 . . . A1A3A5B4 . . . . . B3 . B5 . . . . . . . A1A4B1B4 . . . . . . . . . . . . . . . A1A4B1B3 . B3 . . . B4 . . . . . . . . . A2A4B1 . . . C2 . . . C1 . . . . . . . A2A4B1 . . . B5 . . . B4 . . . . . . . A1A3B1 . . . B5 . . . B5 . . . . . . . A1A3B1 . . . B3 . . . B3 . . . . . . . A1A3A5 . . . B4 . . . B5 . . . . . . . A1A3A5 . . . B3 . . . B1 . . . . . . . A1A4B1 . . . B4 . . . B4 . . . . . . . A1A4B1B3 . B3 . . . B3 . . . . . . . . . A1A3A5B4 . B3 . B4 . . . B4 . B3 . B4 . B3 . A1A3A5B4 . B3 . B4 . B3 . . . . . B1 . . . A1A3B1 . . . . . . . . . . . B3 . . . A1A3B1 . . . . . . . . . . . B4 . . . A1A3A5B5 . . . B5 . . . B5 . . . B5 . . . A1A3A5B5 . . . . . . . B4 . . . . . . . A1A4B1B4 . . . B5 . . . B4 . . . B3 . . . B1 . . . . . . . C1 . . . . . . . A3B1B3B5 . . . . . . . . . . . . . . . B1 . . . . . . . C1 . . . . . . . A1A3B1B5 . . . . . . . . . . . . . . . . . . . . . . . . . . . B3 . . . A1A3A5B4 . . . . . . . . . . . B3 . . . B4 . . . . . . . B3 . . . . . . . A1A4B1B4 . . . B5 . . . B4 . . . B3 . . . B1 . . . . . . . C1 . . . . . . . A3B1B3B5 . . . . . . . . . . . . . . . B1 . . . . . . . C1 . . . . . . . A1A3B1B5 . . . . . . . . . . . B4 . . . . . . . . . . . . . . . B3 . . . A1A3A5B2 . . . . . . . B2 . . . B1 . . . B2 . . . B3 . . . . . . . . . . . A1A4B1B4 . . . B5 . . . B4 . . . B3 . . . B1 . . . . . . . C1 . . . . . . . A3B1B3B5 . . . . . . . . . . . . . . . B1 . . . . . . . C1 . . . . . . . A1A3B1B5 . . . . . . . . . . . . . . . . . . . . . . . . . . . B3 . . . A1A3A5B4 . . . . . . . . . . . B3 . . . B4 . . . . . . . B3 . . . . . . . A1A4B1B4 . . . B5 . . . B4 . . . B3 . . . B1 . . . . . . . C1 . . . . . . . A3B1B3B5 . . . . . . . . . . . . . . . B1 . . . . . . . C1 . . . . . . . A1A3B1B5 . . . . . . . . . . . B4 . . . . . . . . . . . . . . . B3 . . . A1A3A5B2 . . . . . . . B2 . . . B1 . . . B2 . . . B3 . . . . . . . . . . . A1A4B1B3 . . . . . . . . . . . B2 . . . B1 . . . . . . . . . . . A3 . . . A4 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . A2 . . . . . . . A4B1 . . . . . . . . . . . . . . . A4B1 . . . . . . . A1 . . . . . . . A3A5 . . . . . . . . . . . . . . . A3A5 . . . . . . . A1 . . . . . . . A2A5 . . . . . . . . . . . . . . . A2A5 . . . . . . . A1 . . . . . . . A2A5 . . . . . . . . . . . . . . . A2A5 . . . . . . . A2 . . . . . . . A4B1 . . . . . . . B5 . . . . . C1 . A4B1B5 . . . . . B5 . A1 . . . . . . . A3A5 . . . . . . . B5 . . . . . C1 . A3A5B5 . . . . . B5 . A2A5B2 . . . . . B4 . B2 . . . . . . . . . . . . . . . B3 . . . . . . . B2 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . A2 . . . . . . . A4B1 . . . . . . . B5 . . . . . C1 . A4B1B5 . . . . . B5 . A1 . . . . . . . A3A5 . . . . . . . B5 . . . . . C1 . A3A5B5 . . . . . B5 . A1 . . . . . B4 . A2A5B2 . . . . . . . . . . . . . . . A2A5B3 . . . . . . . A1B2 . . . . . . . A2A5 . . . . . B1 . A5 . . . . . . . A2 . . . . . . . A2 . . . . . . . A4B1 . . . . . . . B5 . . . . . C1 . A4B1B5 . . . . . B5 . A1 . . . . . . . A3A5 . . . . . . . B5 . . . . . C1 . A3A5B5 . . . . . B5 . A1 . . . . . B4 . A2A5B2 . . . . . . . . . . . . . . . A2A5 . . . . . . . A1 . . . . . . . A2A5 . . . B3 . . . B4 . . . . . . . A2A5B3 . . . . . . . A2A4B4 . . . B5 . . . A4B1B4 . . . B3 . . . B1 . . . . . . . A4B1C1 . . . . . . . A1B5 . . . . . . . A3A5 . . . . . . . B1 . . . . . . . A3A5C1 . . . . . . . A1A5B5 . . . . . . . A2A5 . . . . . . . . . . . . . . . A2A5 . . . B3 . . . A1A3B4 . . . . . . . A3A5 . . . B3 . . . B4 . . . . . . . A3A5B3 . . . . . . . A2A4B4 . . . B5 . . . A4B1B4 . . . B3 . . . B1 . . . . . . . A4B1C1 . . . . . . . A1B5 . . . . . . . A3A5 . . . . . . . B1 . . . . . . . A3A5C1 . . . . . . . A1A5B5 . . . . . . . A2A5 . . . B4 . . . . . . . . . . . A2A5 . . . B3 . . . A1A3B2 . . . . . . . A3A5B2 . . . B1 . . . B2 . . . B3 . . . A3A5 . . . . . . . A2A4B4 . . . B5 . . . A4B1B4 . . . B3 . . . B1 . . . . . . . A4B1C1 . . . . . . . A1B5 . . . . . . . A3A5 . . . . . . . B1 . . . . . . . A3A5C1 . . . . . . . A1A5B5 . . . . . . . A2A5 . . . . . . . . . . . . . . . A2A5 . . . B3 . . . A1A3B4 . . . . . . . A3A5 . . . B3 . . . B4 . . . . . . . A3A5B3 . . . . . . . A2A4B4 . . . B5 . . . A4B1B4 . . . B3 . . . B1 . . . . . . . A4B1C1 . . . . . . . A1B5 . . . . . . . A3A5 . . . . . . . B1 . . . . . . . A3A5C1 . . . . . . . A1A5B5 . . . . . . . A2A5 . . . B4 . . . . . . . . . . . A2A5 . . . B5 . . . A1A3B5 . . . . . . . A3A5B4 . . . B3 . . . B4 . . . B3 . . . A3A5 . . . . . . . A1A4B1 . . . . . . . . . . . B3 . . . B4 . . . . . B5 . . . . . B4 . . . A3B1B3 . . . . . . . . . . . . . . . B4 . . . . . B3 . . . . . B5 . . . A1A3B1 . . . . . . . . . . . B4 . . . B3 . . . . . . . . . . . B3 . . . A1A3A5B2 . . . . . . . B2 . . . B1 . . . B2 . . . B3 . . . . . . . . . . ."
    ),
}


def play_song(song: Song, bpm: int =None, is_custom: bool = False) -> None:
    """
    Plays the song using the song notes.

    :param song: Song object
    :type song: Song
    :param bpm: Beats per minute to play the song. Default is the song's bpm
    :type bpm: int
    :param is_custom: Not implemented yet
    :type is_custom: bool
    :return: None
    """
    if is_custom:
        raise NotImplementedError("Custom songs are not implemented yet.")

    bpm = bpm or song.bpm
    for i in song_parser(song_notes=song.notes, encoding=song.encoding):
        if isinstance(i, str):
            pydirectinput.press(i)
            continue
        time.sleep(i * bpm/3840)
